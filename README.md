<div align="center">
  <img src="assets/logo.png" alt="YuZaoQianGua" width="256" height="256" />
  <h1>MAOBot</h1>
  <p>基于 <a href="https://github.com/MaaXYZ/MaaFramework" target="_blank">MaaFramework</a> 的阴阳师自动化应用，助力玩家高效管理多账号日常任务</p>
  <p>
    <img src="https://img.shields.io/badge/Python-3776AB?logo=python&logoColor=white" alt="Python" />
  </p>
</div>

---

## 目录

- [简介](#简介)

- [如何安装](#如何安装)
- [功能介绍与使用教程](#功能介绍与使用教程)
- [常见问题](#常见问题)
- [贡献指南](#贡献指南)
- [鸣谢](#鸣谢)
- [许可协议](#许可协议)

---

## 简介

**MAOBot** 即 MAA Assistant Omiyoji Bot ，旨在帮助多号党玩家高效管理多账号（尤其是小号）的日常任务，例如：签到、领取各种每日礼包、检查悬赏任务、查看神秘商店、收取寄养和放置结界卡、混逢魔、同心队刷寮三十或好友助战。
若需要自动做悬赏任务、结界突破、地域鬼王等更复杂的任务自动化，请移步 [MaaYYs](https://github.com/TanyaShue/MaaYYs) 。
**注意：** 本项目仅提供每日任务及基于同心队挂饼的自动化操作，不支持全自动副本战斗，部分功能仍在开发和完善中。
**注意：** 本项目当前仅支持模拟器，不支持 PC 客户端

---

## 如何安装

1. 建议首先前往 [MaaYYs](https://github.com/TanyaShue/MaaYYs) ，**下载全量包** 并解压，可以看到客户端应用 **MFWPH.exe** 以及诸如 runtime、config 等文件夹。
2. 打开 `./assets/resource/` 目录，可以看到目前只有 `MaaYYs` 资源文件夹。
3. 只需下载本项目资源，解压到 `./assets/resource/` 目录下，例如文件夹名称为 `MAOBot`。
4. 回到应用根目录，运行 **MFWPH.exe** ，首次启动需要下载配置程序运行所需的 Python 环境，等待即可。

**注意：** 请将模拟器分辨率修改为 1280*720p。为保证识别效果，建议使用默认庭院皮肤或枫色秋庭庭院皮肤、使用默认的妖伞结界皮肤。
---

## 功能介绍与使用教程

### 账号管理

- 修改 `./assets/resource/MAOBot/assets/account_info.example.csv` 文件，使用记事本打开即可，按照示例行填写自己的账号、平台、服务器名、角色名，每行一个角色。修改完成后，将文件名修改为 `account_info.csv`，为了确保能准确识别，请仔细阅读以下说明：

```
1. `account_info.csv` 文件第一列 `account` 处输入 **账号匹配特征** 字符串，用于在账号选择栏中从上到下划动遍历匹配寻找账号，如果识别结果完整含你在此处填写的字符串就认为识别到了。例如你使用邮箱账号 `yuzaoqian@163.com` 登录游戏，在 `account` 处输入 `yuzaoqian@163.com`、`yuzaoqian@163`、 `yuzaoqian`、`qian@163` 等可以完全匹配的字符串均可。
2. 但是假如你有 2 个账号 `tianzhao123@163.com`、 `tianzhao456@163.com`，在 `account` 处输入 `tianzhao` 是不合适的，因为两个账号都能和它配，最终会导致先识别到哪个账号就选择了哪个。这种情况，可以分别写两个完整的邮箱账号，或者使用 `tianzhao123`、 `zhao456` 等这种能保证只和一个号匹配的字符串。
3. `account` 处并不一定把账号写得越完整越好，因为部分情况下 OCR 识别有误。例如你的账号是 `ll11yys345@163.com`，OCR 可能无法区分相邻的字母 l和数字 1，将其识别为 `1111yys345@163.com`，填写完整账号反而不匹配，导致无法找到账号，建议填写 `yys345` 这种不易被识别错误的字符串去进行匹配。
4. 若你使用手机号登录游戏，在账号选择栏中会显示成隐去中间 4 位的形式，例如 `168****6789`，请不要在 `account_info.csv` 文件的 `account` 中入带星号的内容，建议只写后四位 `6789` 作为识别账号的匹配特征。
5. `account_info.csv` 文件第二列 `platform` 处输入该角色所在的平台，填写 `安卓端` 或 `苹果端`，用于登录账号后选择哪个平台。
6. `account_info.csv` 文件第三列 `servername` 处输入该角色所在的区服名称，例如 “春之樱” ，建议填写完整规范的服务器名称。
7. `account_info.csv` 文件第四列 `rolename` 处输入该角色名，不一定需要和实际角色昵称相同，因为登录一个角色的过程只需要前面三列信息就够了，一列仅为了便于记忆和区分，所以也可以写成其他内容，例如：“大号”、“小号1”、“小号2”，只要不同行的角色名不重复即可，不建议包含特殊字符。（注：好像过 cbg 购入角色可以实现同账号同平台同区有多个角色，但是由于我不掌握这种情况就先不考虑了）。
```

- 打开 `./assets/resource/MAOBot/image/平台区服/` 文件夹，仿照已有的服务器 Logo 截图资源截取你所需要的服务器匹配模板。方法如下：

```
1. 确保模拟器分辨率为 1280*720p，登录账号、选择平台、点击切换按钮、点击一下角色选择栏目的角色名，将向上展开该角色所在的服务器的 Logo。
2. 仿照已有的服务器 Logo 的截图范围，截取你的角色所在的服务器的 Logo，可以更小，不建议比已有这些更大。
3. 将截图保存到 `./assets/resource/MAOBot/image/平台区服/` 文件夹，格式为 png，命名需要和之前你在 `account_info.csv` 文件第三列`servername` 处输入的服务器名称 **完全一致** ，例如：“春之樱.png”。如果前面 csv 文件中你将服务器名称写为 “春区” 等此类自定义名称，那么则需将截图保存为 “春区.png”。
```

### 登录指定角色进行自动任务
  
若想登录指定角色，则勾选 “登录角色” 任务，点击右侧齿轮按钮，在参数设置栏中输入 “账号”、“区服名称”，选择平台类型。这里输入内容的实际作用等于 csv 文件中填写 `account`、`servername` 字段，所以注意事项是相同的。如果任务不能按预期选择账号、角色，请再次仔细阅读前文 [账号管理](#账号管理)。

### 指定角色列表批量完成任务

在任务参数的角色名列表中输入一个用 **英文逗号** 连接的多个角色名，例如：`玉藻前呱,天照呱,小号1,小号2`，任务运行后会自动地逐个登录角色、执行任务、退出登录，便于完成多个账号的签到、查看悬赏等任务。

### 常用的多账号批量任务

1. 查看悬赏封印任务
该任务功能是检查账号的悬赏封印任务中是否包含勾玉任务，如果有，则截图保存到 `screenshot` 文件夹中，你可以在任务执行后查看哪些小号有勾协可以做。

2. 自动收结界寄养和放置结界卡
该任务功能包括领取寮每日工资、体力补给，自动找个太鼓坑位寄养式神（如果所有好友中都没找到太鼓坑位，则不寄养）、自动放置自己的三或四星太鼓结界卡（如果没有三或四星太鼓结界卡，则不放置任何结界卡）。

3. 自动逢魔
该任务功能包括点 4 下现世逢魔领取奖励，找个 Boss 的车混奖励，目前不处理预设队伍和御魂，建议提前配置好默认的阵容和式神御魂，确保能打够一定量伤害拿到结界卡等奖励。开始战斗后就杀后台退出游戏，然后开始登录下个角色执行任务，奖励最终会发放到邮箱中。

4. 查看神秘商店
该任务功能是检查神秘商店出售的物品并截图保存（截图、上划后再截图，每个账号的商店共截两张），方便查看哪些角色上有值得购买或分享的商品。此任务不会刷新商店或自动购买，需要你后续手动介入，购买不同商店的物品或相互分享。

5. 刷同心队
该任务功能相当于：依次点击庭院中的组队按钮、组队界面左下角的同心队按钮、点击预存资源按钮、点击右下角一件预存、点击确定、点击左上角返回、点击集结按钮、点击XX副本集结（不会选择集结哪些队友，因为游戏会自动勾选上次集结的）、点击副本按钮、点击创建队伍（不会选择副本和层数，使用游戏自动记录的上次挑战的副本和层数）、点击左下角自动挑战（不会设置挑战次数，建议提前设置好樱饼次数和出战式神）、等待所有自动挑战次数完成后点击取消按钮、退出到庭院、退出登录。
目前等待自动挑战的时间为 220 秒（约为15次觉醒副本的时间），然后开始检测是否出现了完成挑战次数的弹窗，最多再等待 100 秒，所以请将你设置的总挑战时间控制在 32 0秒内，或者你可以自行修改等待时间参数，位置分别在 `/MAOBot/pipeline/4_同心队.json` 第 100 行和第 104 行。例如你想使用同心队刷 30 次魂土，预先计算从点击自动挑战到所有次数挑战完成需要 X 秒，可以将第 100 行的值修改为一个约为 X*1000 的数，第 104 行的值可以不修改，因为不翻车的情况下不会等待到超时。

---

## 常见问题

1. **为什么不支持全自动战斗？**  
   尊重游戏规则，本项目只提供每日任务和基于同心队或樱饼的自动战斗，不支持全自动无限量刷取副本资源。

2. **可以自定义任务吗？**  
   支持。用户可以通过编写自定义任务流程文件，实现灵活的任务自动化配置。

3. **部分游戏场景无法识别怎么办？**  
   可能是素材不足所致，欢迎大家贡献更多素材，共同完善项目功能。

---

## 贡献指南

感兴趣可以加群645818258讨论。

欢迎开发者参与贡献。在提交 Pull Request 前请确保：

1. 遵循项目的代码风格与规范。
2. 避免提交涉及全自动副本或御魂副本相关功能的代码。

---

## 鸣谢

本项目由 [MaaFramework](https://github.com/MaaXYZ/MaaFramework) 提供强力支持，感谢所有参与和支持项目开发的贡献者！
感谢 [MaaYYs](https://github.com/TanyaShue/MaaYYs) 和 [M9A](https://github.com/MAA1999/M9A) 项目提供了优秀的代码示范，本项目从中学习到很多经验。

---

## 许可协议

本项目采用 **MIT 许可证** 发布，详情请参阅 [LICENSE 文件](LICENSE)。
